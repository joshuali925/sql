<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>How OpenSearch SQL Is Tested &#8212; Example 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="how-opensearch-sql-is-tested">
<h1>How OpenSearch SQL Is Tested<a class="headerlink" href="#how-opensearch-sql-is-tested" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>1.Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<section id="problem-statement">
<h3>1.1 Problem Statement<a class="headerlink" href="#problem-statement" title="Link to this heading">¶</a></h3>
<p>Currently there are quite a few unit tests and integration tests in the codebase. However, there are still problems to rely on these test cases only to ensure the correctness of our plugin:</p>
<ol class="arabic simple">
<li><p><strong>Test coverage</strong>: Although the amount of test cases seems large, we’ve found that more than one important case was missed, for example use table alias in FROM clause, GROUP BY field alias etc.</p></li>
<li><p><strong>Test correctness</strong>: Some test case make assertion on the result set too simple to capture the issue if any. For example, some assertion is as loose as checking if result set is not empty. Unfortunately with strict assertion, we’re still not sure if the assertion is correct or not. For example, there were issue <a class="reference external" href="https://github.com/opendistro-for-elasticsearch/sql/issues/124">#124</a> and <a class="reference external" href="https://github.com/opendistro-for-elasticsearch/sql/issues/226">#226</a> regarding LEFT JOIN with WHERE clause and SUBSTRING. The correct semantic was actually different from what we thought. We did have MySQL reference docs at hands but it’s possible to miss some cases or misunderstand the correct use. So some mechanism is required to replace the loose assertion and be able to enforce the verification of our understanding.</p></li>
<li><p><strong>Test Bench</strong>: We want to run this new test on a regular basis to improving our implementation continuously.</p></li>
</ol>
</section>
<section id="our-goals">
<h3>1.2 Our Goals<a class="headerlink" href="#our-goals" title="Link to this heading">¶</a></h3>
<p>In this work, we want to address the problems above for our testing to get more confidence of the correctness of our plugin. To achieve this goal, we need to improve both the quantity and quality of our tests and also keep it running on a regular basis. Although the search space of SQL is infinite, we can cover typical use cases and corner cases and most importantly make sure it does demonstrate the correctness of our implementation if it can pass.</p>
<blockquote>
<div><p>Note that performance is also another important area that we want to test and understand how efficient or where is the bottleneck of typical queries. Since OpenSearch provides ESRally benchmark tool which is totally different from our homemade test harness, we will be focuses on the correctness and won’t cover performance testing here.</p>
</div></blockquote>
</section>
</section>
<section id="design">
<h2>2.Design<a class="headerlink" href="#design" title="Link to this heading">¶</a></h2>
<section id="approaches">
<h3>2.1 Approaches<a class="headerlink" href="#approaches" title="Link to this heading">¶</a></h3>
<p>First we can improve the test coverage by improving the diversity of our test case set, including diversity of test schema, test data and test cases. Secondly although it’s difficult to provide rigorous mathematical proof for the result set of each query, we can make our best to ensure relative correctness by comparing with a few other database implementations. Of course the comparison testing doesn’t guarantee 100% correctness and heavily depends on the correctness of reference implementation. But it should be much more reliable than hand written assertions after reading specification documentation previously.</p>
</section>
<section id="components">
<h3>2.2 Components<a class="headerlink" href="#components" title="Link to this heading">¶</a></h3>
<p>At this stage we don’t want to spend too much efforts on setting up a complicated infrastructure for testing. So we can take full advantage of capabilities that GitHub provides:</p>
<ol class="arabic simple">
<li><p><strong>Test Data &amp; Cases</strong>: Use test case set with OpenSearch Dashboards flights and ecommerce sample index.</p></li>
<li><p><strong>Trigger</strong>: Set up another GitHub Action workflow.</p></li>
<li><p><strong>Test Runner</strong>: Use embedded OpenSearch and other IMDBs.</p></li>
<li><p><strong>Reporting</strong>: Use standard JUnit report or simple custom json format.</p></li>
<li><p><strong>Visualization</strong>: Enable GitHub Pages for viewing or feed into OpenSearch.</p></li>
</ol>
<p><img alt="Test Framework Components" src="../_images/test-framework-components.png" /></p>
</section>
</section>
<section id="implementation">
<h2>3.Implementation<a class="headerlink" href="#implementation" title="Link to this heading">¶</a></h2>
<section id="test-data">
<h3>3.1 Test Data<a class="headerlink" href="#test-data" title="Link to this heading">¶</a></h3>
<p>For schema, we can just use OpenSearch mapping as the format of schema and convert it to <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> statement. For data we use CSV format simply.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;_doc&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;AvgTicketPrice&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;Cancelled&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;Carrier&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;keyword&quot;</span>
      <span class="p">},</span>
      <span class="o">...</span>
      <span class="o">...</span>
      <span class="s2">&quot;dayOfWeek&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">FlightNum</span><span class="p">,</span><span class="n">Origin</span><span class="p">,</span><span class="n">FlightDelay</span><span class="p">,</span><span class="n">DistanceMiles</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="n">DestCityName</span>
<span class="mi">9</span><span class="n">HY9SWR</span><span class="p">,</span><span class="n">Frankfurt</span> <span class="n">am</span> <span class="n">Main</span> <span class="n">Airport</span><span class="p">,</span><span class="n">false</span><span class="p">,</span><span class="mf">10247.856675613455</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="n">Sydney</span>
<span class="n">X98CCZO</span><span class="p">,</span><span class="n">Cape</span> <span class="n">Town</span> <span class="n">International</span> <span class="n">Airport</span><span class="p">,</span><span class="n">false</span><span class="p">,</span><span class="mf">5482.606664853586</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="n">Venice</span>
<span class="o">......</span>
</pre></div>
</div>
</section>
<section id="test-cases">
<h3>3.2 Test Cases<a class="headerlink" href="#test-cases" title="Link to this heading">¶</a></h3>
<p>For now we don’t implement a Fuzzer to generate test queries because test queries prepared manually is sufficient to help identify issues. So we just put all queries in a text file. In future, a fuzzer can generate queries and save to file to integrate with Test Runner smoothly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT 1 AS `empty` FROM `opensearch_dashboards_sample_data_flights`
SELECT substring(OriginWeather, 1, 2) AS OriginWeather FROM opensearch_dashboards_sample_data_flights
SELECT SUM(FlightDelayMin) AS sum_FlightDelayMin_ok FROM opensearch_dashboards_sample_data_flights
SELECT SUM(FlightDelay) AS sum_FlightDelay_ok FROM opensearch_dashboards_sample_data_flights
SELECT SUM(DistanceMiles) AS sum_DistanceMiles_ok FROM opensearch_dashboards_sample_data_flights
</pre></div>
</div>
</section>
<section id="test-runner">
<h3>3.3 Test Runner<a class="headerlink" href="#test-runner" title="Link to this heading">¶</a></h3>
<p>To simplify the test and be confident about the test result, Test Runner runs query by JDBC driver of OpenSearch SQL and other databases. In this case we don’t need to parse the data format returned from our plugin. And obviously another benefit is the correctness of JDBC driver is also covered.</p>
<p><img alt="How We Do Comparison Test" src="../_images/how-we-do-comparison-test.png" /></p>
</section>
<section id="trigger">
<h3>3.4 Trigger<a class="headerlink" href="#trigger" title="Link to this heading">¶</a></h3>
<p>GitHub Action can be set up to trigger Gradle task to generate test report.</p>
</section>
<section id="reporting">
<h3>3.5 Reporting<a class="headerlink" href="#reporting" title="Link to this heading">¶</a></h3>
<p>OpenSearch integration test is still using JUnit 4 which has many problems, such as dynamic test cases. So we can define our own report format for flexibility:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;failure&quot;</span><span class="p">:</span> <span class="mi">2</span>
  <span class="p">},</span>
  <span class="s2">&quot;tests&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
      <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;Success&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
      <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed&quot;</span><span class="p">,</span>
      <span class="s2">&quot;resultSets&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="s2">&quot;OpenSearch&quot;</span><span class="p">,</span>
          <span class="s2">&quot;resultSet&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">},</span><span class="o">...</span><span class="p">],</span>
            <span class="s2">&quot;dataRows&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="o">...</span><span class="p">],</span><span class="o">...</span><span class="p">,[</span><span class="o">...</span><span class="p">]]</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="s2">&quot;Other database&quot;</span><span class="p">,</span>
          <span class="s2">&quot;resultSet&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">],</span>
            <span class="s2">&quot;dataRows&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="o">...</span><span class="p">],</span><span class="o">...</span><span class="p">,[</span><span class="o">...</span><span class="p">]]</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;sql&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
      <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed&quot;</span><span class="p">,</span>
      <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
    <span class="p">},</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The workflow of generating test result is:</p>
<p><img alt="The Workflow of Comparison Test" src="../_images/the-workflow-of-comparison-test.png" /></p>
<ol class="arabic simple">
<li><p>For the schema, name, type as well as their order requires to be the same.</p></li>
<li><p>For the data rows, only data in each row matters with row order ignored.</p></li>
<li><p>Report success if any other database result can match.</p></li>
<li><p>Report error if all other databases throw exception.</p></li>
<li><p>Report failure otherwise if mismatch and exception mixed.</p></li>
</ol>
</section>
<section id="visualization">
<h3>3.6 Visualization<a class="headerlink" href="#visualization" title="Link to this heading">¶</a></h3>
<p>TODO</p>
</section>
</section>
<hr class="docutils" />
<section id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Link to this heading">¶</a></h2>
<section id="i-sample-usage">
<h3>I.Sample Usage<a class="headerlink" href="#i-sample-usage" title="Link to this heading">¶</a></h3>
<p>Use default test set and reference databases by <code class="docutils literal notranslate"><span class="pre">testType</span></code> argument given only. Because <code class="docutils literal notranslate"><span class="pre">integTestRunner</span></code> triggers quite a few integration tests which take long time and runs with <code class="docutils literal notranslate"><span class="pre">gradlew</span> <span class="pre">build</span></code> every time, <code class="docutils literal notranslate"><span class="pre">testType</span></code> is added to run doctest for documentation and comparison test separately.</p>
<p>Note that for now test data set argument is not supported because it often requires code changes to map more OpenSearch data type to JDBC type as well as convert data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./gradlew :integ-test:comparisonTest

    [2020-01-06T11:37:57,437][INFO ][c.a.o.s.c.CorrectnessIT  ] [performComparisonTest] Starting comparison test
    =================================
    Tested Database  : (Use internal OpenSearch in workspace)
    Other Databases  :
     SQLite = jdbc:sqlite::memory:
     H2 = jdbc:h2:mem:test;DB_CLOSE_DELAY=-1
    Test data set(s) :
    Test data set :
     Table name: opensearch_dashboards_sample_data_flights
     Schema: {
      &quot;mappings&quot;: {
        &quot;properties&quot;: {
          &quot;AvgTicketPrice&quot;: {
            &quot;type&quot;: &quot;float&quot;
          },
          &quot;Cancelled&quot;: {
            &quot;type&quot;: &quot;boolean&quot;
          },
          &quot;Carrier&quot;: {
            &quot;type&quot;: &quot;keyword&quot;
          },
          ...
        }
      }
    }

     Data rows (first 5 in 21):
     [FlightNum, Origin, FlightDelay, DistanceMiles, FlightTimeMin, OriginWeather, dayOfWeek, AvgTicketPrice, Carrier, FlightDelayMin, OriginRegion, FlightDelayType, DestAirportID, Dest, FlightTimeHour, Cancelled, DistanceKilometers, OriginCityName, DestWeather, OriginCountry, DestCountry, DestRegion, OriginAirportID, DestCityName, timestamp]
     [RGXY9H5, Chubu Centrair International Airport, false, 1619.970725161303, 124.1471507959044, Heavy Fog, 0, 626.1297405910661, OpenSearch Dashboards Airlines, 0, SE-BD, No Delay, CAN, Guangzhou Baiyun International Airport, 2.06911917993174, true, 2607.0901667139924, Tokoname, Clear, JP, CN, SE-BD, NGO, Guangzhou, 2019-12-23T11:19:32]
     [WOPNZEP, Munich Airport, true, 198.57903689856937, 34.9738738474057, Sunny, 0, 681.9911763989377, OpenSearch Dashboards Airlines, 15, DE-BY, Carrier Delay, VE05, Venice Marco Polo Airport, 0.5828978974567617, false, 319.58198155849124, Munich, Cloudy, DE, IT, IT-34, MUC, Venice, 2019-12-23T12:32:26]
     [G9J5O2V, Frankfurt am Main Airport, false, 4857.154739888458, 651.402736475921, Clear, 0, 868.0507463122127, OpenSearch Dashboards Airlines, 0, DE-HE, No Delay, XIY, Xi&#39;an Xianyang International Airport, 10.856712274598683, false, 7816.832837711051, Frankfurt am Main, Thunder &amp; Lightning, DE, CN, SE-BD, FRA, Xi&#39;an, 2019-12-23T03:48:33]
     [HM80A5V, Itami Airport, false, 5862.6666599206, 555.0027890084269, Heavy Fog, 0, 765.0413127727119, Logstash Airways, 0, SE-BD, No Delay, TV01, Treviso-Sant&#39;Angelo Airport, 9.250046483473783, true, 9435.047413143258, Osaka, Clear, JP, IT, IT-34, ITM, Treviso, 2019-12-23T19:50:48]

    Test data set :
     Table name: opensearch_dashboards_sample_data_ecommerce
     Schema: {
      &quot;mappings&quot;: {
        &quot;properties&quot;: {
          &quot;category&quot;: {
            &quot;type&quot;: &quot;text&quot;,
            &quot;fields&quot;: {
              &quot;keyword&quot;: {
                &quot;type&quot;: &quot;keyword&quot;
              }
            }
          },
          &quot;currency&quot;: {
            &quot;type&quot;: &quot;keyword&quot;
          },
          &quot;customer_birth_date&quot;: {
            &quot;type&quot;: &quot;date&quot;
          },
          ...
        }
      }
    }
     Data rows (first 5 in 21):
     [customer_first_name, customer_phone, type, manufacturer, customer_full_name, order_date, customer_last_name, day_of_week_i, total_quantity, currency, taxless_total_price, total_unique_products, category, customer_id, sku, order_id, user, customer_gender, email, day_of_week, taxful_total_price]
     [Irwin, , order, [Elitelligence, Microlutions], Irwin Mcdonald, 2019-12-19T23:21:07+00:00, Mcdonald, 3, 2, EUR, 26.98, 2, [Men&#39;s Clothing], 14, [ZO0564605646, ZO0117401174], 551689, irwin, MALE, irwin@mcdonald-family.zzz, Thursday, 26.98]
     [Wilhemina St., , order, [Spherecords Maternity, Oceanavigations], Wilhemina St. Washington, 2019-12-19T08:03:50+00:00, Washington, 3, 2, EUR, 72.98, 2, [Women&#39;s Clothing], 17, [ZO0705107051, ZO0270302703], 550817, wilhemina, FEMALE, wilhemina st.@washington-family.zzz, Thursday, 72.98]
     [Kamal, , order, [Elitelligence, Oceanavigations], Kamal Foster, 2019-12-19T08:47:02+00:00, Foster, 3, 2, EUR, 45.98, 2, [Men&#39;s Clothing], 39, [ZO0532905329, ZO0277802778], 550864, kamal, MALE, kamal@foster-family.zzz, Thursday, 45.98]
     [Diane, , order, [Tigress Enterprises, Low Tide Media], Diane Turner, 2019-12-22T13:45:07+00:00, Turner, 6, 2, EUR, 107.94, 2, [Women&#39;s Clothing, Women&#39;s Shoes], 22, [ZO0059900599, ZO0381103811], 555222, diane, FEMALE, diane@turner-family.zzz, Sunday, 107.94]

    Test query set   : SQL queries (first 5 in 215):
     SELECT SUBSTRING(`opensearch_dashboards_sample_data_flights`.`OriginWeather`, 1, 1024) AS `OriginWeather` FROM `opensearch_dashboards_sample_data_flights` GROUP BY 1
     SELECT SUM(`opensearch_dashboards_sample_data_flights`.`FlightDelayMin`) AS `sum_Offset_ok` FROM `opensearch_dashboards_sample_data_flights` GROUP BY 1
     SELECT SUM(`opensearch_dashboards_sample_data_flights`.`FlightDelay`) AS `sum_FlightDelay_ok` FROM `opensearch_dashboards_sample_data_flights` GROUP BY 1
     SELECT SUM(`opensearch_dashboards_sample_data_flights`.`DistanceMiles`) AS `sum_DistanceMiles_ok` FROM `opensearch_dashboards_sample_data_flights` GROUP BY 1
     SELECT YEAR(`opensearch_dashboards_sample_data_flights`.`timestamp`) AS `yr_timestamp_ok` FROM `opensearch_dashboards_sample_data_flights` GROUP BY 1

    =================================

    [2020-01-06T11:37:57,996][INFO ][c.a.o.s.c.CorrectnessIT  ] [performComparisonTest] Loading test data set...
    [2020-01-06T11:38:06,308][INFO ][c.a.o.s.c.CorrectnessIT  ] [performComparisonTest] Verifying test queries...
    [2020-01-06T11:38:21,180][INFO ][c.a.o.s.c.CorrectnessIT  ] [performComparisonTest] Saving test report to disk...
    [2020-01-06T11:38:21,202][INFO ][c.a.o.s.c.CorrectnessIT  ] [performComparisonTest] Report file location is /Users/xxx/Workspace/sql/reports/report_2020-01-06-19.json
    [2020-01-06T11:38:21,204][INFO ][c.a.o.s.c.CorrectnessIT  ] [performComparisonTest] Cleaning up test data...
    [2020-01-06T11:38:21,849][INFO ][c.a.o.s.c.CorrectnessIT  ] [performComparisonTest] Completed comparison test.
</pre></div>
</div>
<p>Specify different test case set by <code class="docutils literal notranslate"><span class="pre">queries</span></code> argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./gradlew :integ-test:comparisonTest -Dqueries=sanity_integration_tests.txt

    ...
    Test query set   : SQL queries (first 5 in 7):
     SELECT AvgTicketPrice, Cancelled, Carrier, FlightDelayMin, timestamp FROM opensearch_dashboards_sample_data_flights
     SELECT AvgTicketPrice AS avg, Cancelled AS cancel, Carrier AS carrier, FlightDelayMin AS delay, timestamp AS ts FROM opensearch_dashboards_sample_data_flights
     SELECT Carrier, AVG(FlightDelayMin) FROM opensearch_dashboards_sample_data_flights GROUP BY Carrier
     SELECT Carrier, AVG(FlightDelayMin) FROM opensearch_dashboards_sample_data_flights GROUP BY Carrier HAVING AVG(FlightDelayMin) &gt; 5
     SELECT YEAR(timestamp) FROM opensearch_dashboards_sample_data_flights
    ...
</pre></div>
</div>
<p>Specify external OpenSearch cluster by <code class="docutils literal notranslate"><span class="pre">esHost</span></code> argument, otherwise an internal OpenSearch in workspace is in use by default.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./gradlew :integ-test:comparisonTest -DesHost=localhost:9200

    =================================
    Tested Database  : localhost:9200
    Other Databases  :
     SQLite = jdbc:sqlite::memory:
     H2 = jdbc:h2:mem:test;DB_CLOSE_DELAY=-1
    ...
</pre></div>
</div>
<p>Specify different databases for comparison. <code class="docutils literal notranslate"><span class="pre">dbUrl</span></code> is for database to be tested. <code class="docutils literal notranslate"><span class="pre">otherDbUrls</span></code> is for other databases whose result set be referenced and compared.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./gradlew :integ-test:comparisonTest -Dqueries=sanity_integration_tests.txt -DdbUrl=jdbc:sqlite::memory:

    =================================
    Tested Database  : jdbc:sqlite::memory:
    Other Databases  :
     SQLite = jdbc:sqlite::memory:
     H2 = jdbc:h2:mem:test;DB_CLOSE_DELAY=-1
    ...

$ ./gradlew :integ-test:comparisonTest -Dqueries=sanity_integration_tests.txt -DdbUrl=jdbc:sqlite::memory: -DotherDbUrls=Unknown=jdbc:h2:mem:test;DB_CLOSE_DELAY=-1

    =================================
    Tested Database  : jdbc:sqlite::memory:
    Other Databases  :
     Unknown = jdbc:h2:mem:test
    ...
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Example</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;workshop participant.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/dev/testing-comparison-test.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>