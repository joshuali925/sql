<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Aggregation &#8212; sql-docs  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="aggregation">
<h1>Aggregation<a class="headerlink" href="#aggregation" title="Link to this heading">¶</a></h1>
<p class="rubric">Table of contents</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id18">Introduction</a></p></li>
<li><p><a class="reference internal" href="#group-by-clause" id="id19">GROUP BY Clause</a></p>
<ul>
<li><p><a class="reference internal" href="#description" id="id20">Description</a></p></li>
<li><p><a class="reference internal" href="#identifier" id="id21">Identifier</a></p></li>
<li><p><a class="reference internal" href="#ordinal" id="id22">Ordinal</a></p></li>
<li><p><a class="reference internal" href="#expression" id="id23">Expression</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id1" id="id24">Aggregation</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id25">Description</a></p></li>
<li><p><a class="reference internal" href="#aggregation-in-select" id="id26">Aggregation in Select</a></p></li>
<li><p><a class="reference internal" href="#expression-over-aggregation" id="id27">Expression over Aggregation</a></p></li>
<li><p><a class="reference internal" href="#expression-as-argument-of-aggregation" id="id28">Expression as argument of Aggregation</a></p></li>
<li><p><a class="reference internal" href="#count-aggregations" id="id29">COUNT Aggregations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#aggregation-functions" id="id30">Aggregation Functions</a></p>
<ul>
<li><p><a class="reference internal" href="#count" id="id31">COUNT</a></p></li>
<li><p><a class="reference internal" href="#sum" id="id32">SUM</a></p></li>
<li><p><a class="reference internal" href="#avg" id="id33">AVG</a></p></li>
<li><p><a class="reference internal" href="#max" id="id34">MAX</a></p></li>
<li><p><a class="reference internal" href="#min" id="id35">MIN</a></p></li>
<li><p><a class="reference internal" href="#var-pop" id="id36">VAR_POP</a></p></li>
<li><p><a class="reference internal" href="#var-samp" id="id37">VAR_SAMP</a></p></li>
<li><p><a class="reference internal" href="#variance" id="id38">VARIANCE</a></p></li>
<li><p><a class="reference internal" href="#stddev-pop" id="id39">STDDEV_POP</a></p></li>
<li><p><a class="reference internal" href="#stddev-samp" id="id40">STDDEV_SAMP</a></p></li>
<li><p><a class="reference internal" href="#std" id="id41">STD</a></p></li>
<li><p><a class="reference internal" href="#stddev" id="id42">STDDEV</a></p></li>
<li><p><a class="reference internal" href="#distinct-count-aggregation" id="id43">DISTINCT COUNT Aggregation</a></p></li>
<li><p><a class="reference internal" href="#percentile-or-percentile-approx" id="id44">PERCENTILE or PERCENTILE_APPROX</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#having-clause" id="id45">HAVING Clause</a></p>
<ul>
<li><p><a class="reference internal" href="#id16" id="id46">Description</a></p></li>
<li><p><a class="reference internal" href="#having-with-group-by" id="id47">HAVING with GROUP BY</a></p></li>
<li><p><a class="reference internal" href="#having-without-group-by" id="id48">HAVING without GROUP BY</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#filter-clause" id="id49">FILTER Clause</a></p>
<ul>
<li><p><a class="reference internal" href="#id17" id="id50">Description</a></p></li>
<li><p><a class="reference internal" href="#filter-with-group-by" id="id51">FILTER with GROUP BY</a></p></li>
<li><p><a class="reference internal" href="#filter-without-group-by" id="id52">FILTER without GROUP BY</a></p></li>
<li><p><a class="reference internal" href="#distinct-count-aggregate-with-filter" id="id53">Distinct count aggregate with FILTER</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>Aggregate functions operate on sets of values. They are often used with a GROUP BY clause to group values into subsets.</p>
</section>
<section id="group-by-clause">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">GROUP BY Clause</a><a class="headerlink" href="#group-by-clause" title="Link to this heading">¶</a></h2>
<section id="description">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h3>
<p>The GROUP BY expression could be</p>
<ol class="arabic simple">
<li><p>Identifier</p></li>
<li><p>Ordinal</p></li>
<li><p>Expression</p></li>
</ol>
</section>
<section id="identifier">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Identifier</a><a class="headerlink" href="#identifier" title="Link to this heading">¶</a></h3>
<p>The group by expression could be identifier:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">gender</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------+------------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">|----------+------------|</span>
<span class="o">|</span> <span class="n">F</span>        <span class="o">|</span> <span class="mi">28</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">101</span>        <span class="o">|</span>
<span class="o">+----------+------------+</span>
</pre></div>
</div>
</section>
<section id="ordinal">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Ordinal</a><a class="headerlink" href="#ordinal" title="Link to this heading">¶</a></h3>
<p>The group by expression could be ordinal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">gender</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------+------------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">|----------+------------|</span>
<span class="o">|</span> <span class="n">F</span>        <span class="o">|</span> <span class="mi">28</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">101</span>        <span class="o">|</span>
<span class="o">+----------+------------+</span>
</pre></div>
</div>
</section>
<section id="expression">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Expression</a><a class="headerlink" href="#expression" title="Link to this heading">¶</a></h3>
<p>The group by expression could be expression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="nb">abs</span><span class="p">(</span><span class="n">account_number</span><span class="p">),</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="nb">abs</span><span class="p">(</span><span class="n">account_number</span><span class="p">);</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">4</span>
<span class="o">+-----------------------+------------+</span>
<span class="o">|</span> <span class="nb">abs</span><span class="p">(</span><span class="n">account_number</span><span class="p">)</span>   <span class="o">|</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">|-----------------------+------------|</span>
<span class="o">|</span> <span class="mi">1</span>                     <span class="o">|</span> <span class="mi">32</span>         <span class="o">|</span>
<span class="o">|</span> <span class="mi">13</span>                    <span class="o">|</span> <span class="mi">28</span>         <span class="o">|</span>
<span class="o">|</span> <span class="mi">18</span>                    <span class="o">|</span> <span class="mi">33</span>         <span class="o">|</span>
<span class="o">|</span> <span class="mi">6</span>                     <span class="o">|</span> <span class="mi">36</span>         <span class="o">|</span>
<span class="o">+-----------------------+------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="id1">
<h2><a class="toc-backref" href="#id24" role="doc-backlink">Aggregation</a><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<section id="id2">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Description</a><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>The aggregation could be used select.</p></li>
<li><p>The aggregation could be used as arguments of expression.</p></li>
<li><p>The aggregation could has expression as arguments.</p></li>
</ol>
</section>
<section id="aggregation-in-select">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Aggregation in Select</a><a class="headerlink" href="#aggregation-in-select" title="Link to this heading">¶</a></h3>
<p>The aggregation could be used select:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">gender</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------+------------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">|----------+------------|</span>
<span class="o">|</span> <span class="n">F</span>        <span class="o">|</span> <span class="mi">28</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">101</span>        <span class="o">|</span>
<span class="o">+----------+------------+</span>
</pre></div>
</div>
</section>
<section id="expression-over-aggregation">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Expression over Aggregation</a><a class="headerlink" href="#expression-over-aggregation" title="Link to this heading">¶</a></h3>
<p>The aggregation could be used as arguments of expression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">gender</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">as</span> <span class="n">sum2</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------+--------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="n">sum2</span>   <span class="o">|</span>
<span class="o">|----------+--------|</span>
<span class="o">|</span> <span class="n">F</span>        <span class="o">|</span> <span class="mi">56</span>     <span class="o">|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">202</span>    <span class="o">|</span>
<span class="o">+----------+--------+</span>
</pre></div>
</div>
</section>
<section id="expression-as-argument-of-aggregation">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Expression as argument of Aggregation</a><a class="headerlink" href="#expression-as-argument-of-aggregation" title="Link to this heading">¶</a></h3>
<p>The aggregation could has expression as arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">gender</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">sum2</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------+--------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="n">sum2</span>   <span class="o">|</span>
<span class="o">|----------+--------|</span>
<span class="o">|</span> <span class="n">F</span>        <span class="o">|</span> <span class="mi">56</span>     <span class="o">|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">202</span>    <span class="o">|</span>
<span class="o">+----------+--------+</span>
</pre></div>
</div>
</section>
<section id="count-aggregations">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">COUNT Aggregations</a><a class="headerlink" href="#count-aggregations" title="Link to this heading">¶</a></h3>
<p>Besides regular identifiers, <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> aggregate function also accepts arguments such as <code class="docutils literal notranslate"><span class="pre">*</span></code> or literals like <code class="docutils literal notranslate"><span class="pre">1</span></code>. The meaning of these different forms are as follows:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">COUNT(field)</span></code> will count only if given field (or expression) is not null or missing in the input rows.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COUNT(*)</span></code> will count the number of all its input rows.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COUNT(1)</span></code> is same as <code class="docutils literal notranslate"><span class="pre">COUNT(*)</span></code> because any non-null literal will count.</p></li>
</ol>
</section>
</section>
<section id="aggregation-functions">
<h2><a class="toc-backref" href="#id30" role="doc-backlink">Aggregation Functions</a><a class="headerlink" href="#aggregation-functions" title="Link to this heading">¶</a></h2>
<section id="count">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">COUNT</a><a class="headerlink" href="#count" title="Link to this heading">¶</a></h3>
<section id="id3">
<h4>Description<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<p>Usage: Returns a count of the number of expr in the rows retrieved by a SELECT statement.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">gender</span><span class="p">,</span> <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">countV</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------+----------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="n">countV</span>   <span class="o">|</span>
<span class="o">|----------+----------|</span>
<span class="o">|</span> <span class="n">F</span>        <span class="o">|</span> <span class="mi">1</span>        <span class="o">|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">3</span>        <span class="o">|</span>
<span class="o">+----------+----------+</span>
</pre></div>
</div>
</section>
</section>
<section id="sum">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">SUM</a><a class="headerlink" href="#sum" title="Link to this heading">¶</a></h3>
<section id="id4">
<h4>Description<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<p>Usage: SUM(expr). Returns the sum of <cite>expr</cite>. <cite>expr</cite> could be of any of the numeric data types.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">gender</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">sumV</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------+--------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="n">sumV</span>   <span class="o">|</span>
<span class="o">|----------+--------|</span>
<span class="o">|</span> <span class="n">F</span>        <span class="o">|</span> <span class="mi">28</span>     <span class="o">|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">101</span>    <span class="o">|</span>
<span class="o">+----------+--------+</span>
</pre></div>
</div>
</section>
</section>
<section id="avg">
<h3><a class="toc-backref" href="#id33" role="doc-backlink">AVG</a><a class="headerlink" href="#avg" title="Link to this heading">¶</a></h3>
<section id="id5">
<h4>Description<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
<p>Usage: AVG(expr). Returns the average value of <cite>expr</cite>. <cite>expr</cite> can be any numeric or datetime data type. Datetime aggregation is performed with milliseconds precision.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">gender</span><span class="p">,</span> <span class="n">avg</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">avgV</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------+--------------------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="n">avgV</span>               <span class="o">|</span>
<span class="o">|----------+--------------------|</span>
<span class="o">|</span> <span class="n">F</span>        <span class="o">|</span> <span class="mf">28.0</span>               <span class="o">|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mf">33.666666666666664</span> <span class="o">|</span>
<span class="o">+----------+--------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="max">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">MAX</a><a class="headerlink" href="#max" title="Link to this heading">¶</a></h3>
<section id="id6">
<h4>Description<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h4>
<p>Usage: MAX(expr). Returns the maximum value of <cite>expr</cite>. <cite>expr</cite> can be any numeric or datetime data type. Datetime aggregation is performed with milliseconds precision.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="nb">max</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">maxV</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------+</span>
<span class="o">|</span> <span class="n">maxV</span>   <span class="o">|</span>
<span class="o">|--------|</span>
<span class="o">|</span> <span class="mi">36</span>     <span class="o">|</span>
<span class="o">+--------+</span>
</pre></div>
</div>
</section>
</section>
<section id="min">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">MIN</a><a class="headerlink" href="#min" title="Link to this heading">¶</a></h3>
<section id="id7">
<h4>Description<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h4>
<p>Usage: MIN(expr). Returns the minimum value of <cite>expr</cite>. <cite>expr</cite> can be any numeric or datetime data type. Datetime aggregation is performed with milliseconds precision.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="nb">min</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">minV</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------+</span>
<span class="o">|</span> <span class="n">minV</span>   <span class="o">|</span>
<span class="o">|--------|</span>
<span class="o">|</span> <span class="mi">28</span>     <span class="o">|</span>
<span class="o">+--------+</span>
</pre></div>
</div>
</section>
</section>
<section id="var-pop">
<h3><a class="toc-backref" href="#id36" role="doc-backlink">VAR_POP</a><a class="headerlink" href="#var-pop" title="Link to this heading">¶</a></h3>
<section id="id8">
<h4>Description<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<p>Usage: VAR_POP(expr). Returns the population standard variance of expr.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">var_pop</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">varV</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------+</span>
<span class="o">|</span> <span class="n">varV</span>   <span class="o">|</span>
<span class="o">|--------|</span>
<span class="o">|</span> <span class="mf">8.1875</span> <span class="o">|</span>
<span class="o">+--------+</span>
</pre></div>
</div>
</section>
</section>
<section id="var-samp">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">VAR_SAMP</a><a class="headerlink" href="#var-samp" title="Link to this heading">¶</a></h3>
<section id="id9">
<h4>Description<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<p>Usage: VAR_SAMP(expr). Returns the sample variance of expr.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">var_samp</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">varV</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">varV</span>               <span class="o">|</span>
<span class="o">|--------------------|</span>
<span class="o">|</span> <span class="mf">10.916666666666666</span> <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="variance">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">VARIANCE</a><a class="headerlink" href="#variance" title="Link to this heading">¶</a></h3>
<section id="id10">
<h4>Description<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h4>
<p>Usage: VARIANCE(expr). Returns the population standard variance of expr. VARIANCE() is a synonym VAR_POP() function.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">variance</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">varV</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------+</span>
<span class="o">|</span> <span class="n">varV</span>   <span class="o">|</span>
<span class="o">|--------|</span>
<span class="o">|</span> <span class="mf">8.1875</span> <span class="o">|</span>
<span class="o">+--------+</span>
</pre></div>
</div>
</section>
</section>
<section id="stddev-pop">
<h3><a class="toc-backref" href="#id39" role="doc-backlink">STDDEV_POP</a><a class="headerlink" href="#stddev-pop" title="Link to this heading">¶</a></h3>
<section id="id11">
<h4>Description<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h4>
<p>Usage: STDDEV_POP(expr). Returns the population standard deviation of expr.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">stddev_pop</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">stddevV</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">stddevV</span>            <span class="o">|</span>
<span class="o">|--------------------|</span>
<span class="o">|</span> <span class="mf">2.8613807855648994</span> <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="stddev-samp">
<h3><a class="toc-backref" href="#id40" role="doc-backlink">STDDEV_SAMP</a><a class="headerlink" href="#stddev-samp" title="Link to this heading">¶</a></h3>
<section id="id12">
<h4>Description<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h4>
<p>Usage: STDDEV_SAMP(expr). Returns the sample standard deviation of expr.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">stddev_samp</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">stddevV</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+-------------------+</span>
<span class="o">|</span> <span class="n">stddevV</span>           <span class="o">|</span>
<span class="o">|-------------------|</span>
<span class="o">|</span> <span class="mf">3.304037933599835</span> <span class="o">|</span>
<span class="o">+-------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="std">
<h3><a class="toc-backref" href="#id41" role="doc-backlink">STD</a><a class="headerlink" href="#std" title="Link to this heading">¶</a></h3>
<section id="id13">
<h4>Description<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h4>
<p>Usage: STD(expr). Returns the population standard deviation of expr. STD() is a synonym STDDEV_POP() function.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">stddev_pop</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">stddevV</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">stddevV</span>            <span class="o">|</span>
<span class="o">|--------------------|</span>
<span class="o">|</span> <span class="mf">2.8613807855648994</span> <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="stddev">
<h3><a class="toc-backref" href="#id42" role="doc-backlink">STDDEV</a><a class="headerlink" href="#stddev" title="Link to this heading">¶</a></h3>
<section id="id14">
<h4>Description<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h4>
<p>Usage: STDDEV(expr). Returns the population standard deviation of expr. STDDEV() is a synonym STDDEV_POP() function.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">stddev</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">as</span> <span class="n">stddevV</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">stddevV</span>            <span class="o">|</span>
<span class="o">|--------------------|</span>
<span class="o">|</span> <span class="mf">2.8613807855648994</span> <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="distinct-count-aggregation">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">DISTINCT COUNT Aggregation</a><a class="headerlink" href="#distinct-count-aggregation" title="Link to this heading">¶</a></h3>
<p>To get the count of distinct values of a field, you can add a keyword <code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> before the field in the count aggregation. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">COUNT</span><span class="p">(</span><span class="n">DISTINCT</span> <span class="n">gender</span><span class="p">),</span> <span class="n">COUNT</span><span class="p">(</span><span class="n">gender</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">accounts</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------------------------+-----------------+</span>
<span class="o">|</span> <span class="n">COUNT</span><span class="p">(</span><span class="n">DISTINCT</span> <span class="n">gender</span><span class="p">)</span>   <span class="o">|</span> <span class="n">COUNT</span><span class="p">(</span><span class="n">gender</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">|--------------------------+-----------------|</span>
<span class="o">|</span> <span class="mi">2</span>                        <span class="o">|</span> <span class="mi">4</span>               <span class="o">|</span>
<span class="o">+--------------------------+-----------------+</span>
</pre></div>
</div>
</section>
<section id="percentile-or-percentile-approx">
<h3><a class="toc-backref" href="#id44" role="doc-backlink">PERCENTILE or PERCENTILE_APPROX</a><a class="headerlink" href="#percentile-or-percentile-approx" title="Link to this heading">¶</a></h3>
<section id="id15">
<h4>Description<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h4>
<p>Usage: PERCENTILE(expr, percent) or PERCENTILE_APPROX(expr, percent). Returns the approximate percentile value of <cite>expr</cite> at the specified percentage. <cite>percent</cite> must be a constant between 0 and 100.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">gender</span><span class="p">,</span> <span class="n">percentile</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span> <span class="k">as</span> <span class="n">p90</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------+-------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="n">p90</span>   <span class="o">|</span>
<span class="o">|----------+-------|</span>
<span class="o">|</span> <span class="n">F</span>        <span class="o">|</span> <span class="mi">28</span>    <span class="o">|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">36</span>    <span class="o">|</span>
<span class="o">+----------+-------+</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="having-clause">
<h2><a class="toc-backref" href="#id45" role="doc-backlink">HAVING Clause</a><a class="headerlink" href="#having-clause" title="Link to this heading">¶</a></h2>
<section id="id16">
<h3><a class="toc-backref" href="#id46" role="doc-backlink">Description</a><a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> clause can serve as aggregation filter that filters out aggregated values satisfy the condition expression given.</p>
</section>
<section id="having-with-group-by">
<h3><a class="toc-backref" href="#id47" role="doc-backlink">HAVING with GROUP BY</a><a class="headerlink" href="#having-with-group-by" title="Link to this heading">¶</a></h3>
<p>Aggregate expressions or its alias defined in <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> clause can be used in <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> condition.</p>
<ol class="arabic simple">
<li><p>It’s recommended to use non-aggregate expression in <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> although it’s allowed to do this in <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> clause.</p></li>
<li><p>The aggregation in <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> clause is not necessarily same as that on select list. As extension to SQL standard, it’s also not restricted to involve identifiers only on group by list.</p></li>
</ol>
<p>Here is an example for typical use of <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> clause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span>
<span class="o">...</span>  <span class="n">gender</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<span class="o">...</span> <span class="n">FROM</span> <span class="n">accounts</span>
<span class="o">...</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span>
<span class="o">...</span> <span class="n">HAVING</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+----------+------------+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">|----------+------------|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">101</span>        <span class="o">|</span>
<span class="o">+----------+------------+</span>
</pre></div>
</div>
<p>Here is another example for using alias in <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> condition. Note that if an identifier is ambiguous, for example present both as a select alias and an index field, preference is alias. This means the identifier will be replaced by expression aliased in <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> clause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span>
<span class="o">...</span>  <span class="n">gender</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="n">AS</span> <span class="n">s</span>
<span class="o">...</span> <span class="n">FROM</span> <span class="n">accounts</span>
<span class="o">...</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span>
<span class="o">...</span> <span class="n">HAVING</span> <span class="n">s</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+----------+-----+</span>
<span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span> <span class="n">s</span>   <span class="o">|</span>
<span class="o">|----------+-----|</span>
<span class="o">|</span> <span class="n">M</span>        <span class="o">|</span> <span class="mi">101</span> <span class="o">|</span>
<span class="o">+----------+-----+</span>
</pre></div>
</div>
</section>
<section id="having-without-group-by">
<h3><a class="toc-backref" href="#id48" role="doc-backlink">HAVING without GROUP BY</a><a class="headerlink" href="#having-without-group-by" title="Link to this heading">¶</a></h3>
<p>Additionally, a <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> clause can work without <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> clause. This is useful because aggregation is not allowed to be present in <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span>
<span class="o">...</span>  <span class="s1">&#39;Total of age &gt; 100&#39;</span>
<span class="o">...</span> <span class="n">FROM</span> <span class="n">accounts</span>
<span class="o">...</span> <span class="n">HAVING</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+------------------------+</span>
<span class="o">|</span> <span class="s1">&#39;Total of age &gt; 100&#39;</span>   <span class="o">|</span>
<span class="o">|------------------------|</span>
<span class="o">|</span> <span class="n">Total</span> <span class="n">of</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="mi">100</span>     <span class="o">|</span>
<span class="o">+------------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="filter-clause">
<h2><a class="toc-backref" href="#id49" role="doc-backlink">FILTER Clause</a><a class="headerlink" href="#filter-clause" title="Link to this heading">¶</a></h2>
<section id="id17">
<h3><a class="toc-backref" href="#id50" role="doc-backlink">Description</a><a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">FILTER</span></code> clause can set specific condition for the current aggregation bucket, following the syntax <code class="docutils literal notranslate"><span class="pre">aggregation_function(expr)</span> <span class="pre">FILTER(WHERE</span> <span class="pre">condition_expr)</span></code>. If a filter is specified, then only the input rows for which the condition in the filter clause evaluates to true are fed to the aggregate function; other rows are discarded. The aggregation with filter clause can be use in <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> clause only.</p>
</section>
<section id="filter-with-group-by">
<h3><a class="toc-backref" href="#id51" role="doc-backlink">FILTER with GROUP BY</a><a class="headerlink" href="#filter-with-group-by" title="Link to this heading">¶</a></h3>
<p>The group by aggregation with <code class="docutils literal notranslate"><span class="pre">FILTER</span></code> clause can set different conditions for each aggregation bucket. Here is an example to use <code class="docutils literal notranslate"><span class="pre">FILTER</span></code> in group by aggregation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">avg</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="n">FILTER</span><span class="p">(</span><span class="n">WHERE</span> <span class="n">balance</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">)</span> <span class="n">AS</span> <span class="n">filtered</span><span class="p">,</span> <span class="n">gender</span> <span class="n">FROM</span> <span class="n">accounts</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">gender</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+------------+----------+</span>
<span class="o">|</span> <span class="n">filtered</span>   <span class="o">|</span> <span class="n">gender</span>   <span class="o">|</span>
<span class="o">|------------+----------|</span>
<span class="o">|</span> <span class="mf">28.0</span>       <span class="o">|</span> <span class="n">F</span>        <span class="o">|</span>
<span class="o">|</span> <span class="mf">32.0</span>       <span class="o">|</span> <span class="n">M</span>        <span class="o">|</span>
<span class="o">+------------+----------+</span>
</pre></div>
</div>
</section>
<section id="filter-without-group-by">
<h3><a class="toc-backref" href="#id52" role="doc-backlink">FILTER without GROUP BY</a><a class="headerlink" href="#filter-without-group-by" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">FILTER</span></code> clause can be used in aggregation functions without GROUP BY as well. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span>
<span class="o">...</span>   <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">AS</span> <span class="n">unfiltered</span><span class="p">,</span>
<span class="o">...</span>   <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">FILTER</span><span class="p">(</span><span class="n">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="mi">34</span><span class="p">)</span> <span class="n">AS</span> <span class="n">filtered</span>
<span class="o">...</span> <span class="n">FROM</span> <span class="n">accounts</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+--------------+------------+</span>
<span class="o">|</span> <span class="n">unfiltered</span>   <span class="o">|</span> <span class="n">filtered</span>   <span class="o">|</span>
<span class="o">|--------------+------------|</span>
<span class="o">|</span> <span class="mi">4</span>            <span class="o">|</span> <span class="mi">1</span>          <span class="o">|</span>
<span class="o">+--------------+------------+</span>
</pre></div>
</div>
</section>
<section id="distinct-count-aggregate-with-filter">
<h3><a class="toc-backref" href="#id53" role="doc-backlink">Distinct count aggregate with FILTER</a><a class="headerlink" href="#distinct-count-aggregate-with-filter" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">FILTER</span></code> clause is also used in distinct count to do the filtering before count the distinct values of specific field. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">COUNT</span><span class="p">(</span><span class="n">DISTINCT</span> <span class="n">firstname</span><span class="p">)</span> <span class="n">FILTER</span><span class="p">(</span><span class="n">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="n">AS</span> <span class="n">distinct_count</span> <span class="n">FROM</span> <span class="n">accounts</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+------------------+</span>
<span class="o">|</span> <span class="n">distinct_count</span>   <span class="o">|</span>
<span class="o">|------------------|</span>
<span class="o">|</span> <span class="mi">3</span>                <span class="o">|</span>
<span class="o">+------------------+</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">sql-docs</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, josh.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../_sources/docs/user/dql/aggregations.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>