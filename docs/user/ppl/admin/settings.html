<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PPL Settings &#8212; sql-docs  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ppl-settings">
<h1>PPL Settings<a class="headerlink" href="#ppl-settings" title="Link to this heading">¶</a></h1>
<p class="rubric">Table of contents</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id4">Introduction</a></p></li>
<li><p><a class="reference internal" href="#plugins-ppl-enabled" id="id5">plugins.ppl.enabled</a></p></li>
<li><p><a class="reference internal" href="#plugins-query-memory-limit" id="id6">plugins.query.memory_limit</a></p></li>
<li><p><a class="reference internal" href="#plugins-query-size-limit" id="id7">plugins.query.size_limit</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>When OpenSearch bootstraps, PPL plugin will register a few settings in OpenSearch cluster settings. Most of the settings are able to change dynamically so you can control the behavior of PPL plugin without need to bounce your cluster.</p>
</section>
<section id="plugins-ppl-enabled">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">plugins.ppl.enabled</a><a class="headerlink" href="#plugins-ppl-enabled" title="Link to this heading">¶</a></h2>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Link to this heading">¶</a></h3>
<p>You can disable SQL plugin to reject all coming requests.</p>
<ol class="arabic simple">
<li><p>The default value is true.</p></li>
<li><p>This setting is node scope.</p></li>
<li><p>This setting can be updated dynamically.</p></li>
</ol>
<p>Notes. Calls to _plugins/_ppl include index names in the request body, so they have the same access policy considerations as the bulk, mget, and msearch operations. if rest.action.multi.allow_explicit_index set to false, PPL plugin will be disabled.</p>
</section>
<section id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Link to this heading">¶</a></h3>
<p>You can update the setting with a new value like this.</p>
<p>PPL query:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sh$<span class="w"> </span>curl<span class="w"> </span>-sS<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>localhost:9200/_plugins/_query/settings<span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;transient&quot; : {&quot;plugins.ppl.enabled&quot; : &quot;false&quot;}}&#39;</span>
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;acknowledged&quot;</span>:<span class="w"> </span>true,
<span class="w">  </span><span class="s2">&quot;persistent&quot;</span>:<span class="w"> </span><span class="o">{}</span>,
<span class="w">  </span><span class="s2">&quot;transient&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;plugins&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">      </span><span class="s2">&quot;ppl&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span><span class="s2">&quot;false&quot;</span>
<span class="w">      </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Note: the legacy settings of <code class="docutils literal notranslate"><span class="pre">opendistro.ppl.enabled</span></code> is deprecated, it will fallback to the new settings if you request an update with the legacy name.</p>
</section>
<section id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Link to this heading">¶</a></h3>
<p>Query result after the setting updated is like:</p>
<p>PPL query:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sh$<span class="w"> </span>curl<span class="w"> </span>-sS<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>localhost:9200/_plugins/_ppl<span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;query&quot;: &quot;source=my_prometheus&quot;}&#39;</span>
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;error&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;reason&quot;</span>:<span class="w"> </span><span class="s2">&quot;Invalid Query&quot;</span>,
<span class="w">    </span><span class="s2">&quot;details&quot;</span>:<span class="w"> </span><span class="s2">&quot;Either plugins.ppl.enabled or rest.action.multi.allow_explicit_index setting is false&quot;</span>,
<span class="w">    </span><span class="s2">&quot;type&quot;</span>:<span class="w"> </span><span class="s2">&quot;IllegalAccessException&quot;</span>
<span class="w">  </span><span class="o">}</span>,
<span class="w">  </span><span class="s2">&quot;status&quot;</span>:<span class="w"> </span><span class="m">400</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="example-3">
<h3>Example 3<a class="headerlink" href="#example-3" title="Link to this heading">¶</a></h3>
<p>You can reset the setting to default value like this.</p>
<p>PPL query:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sh$<span class="w"> </span>curl<span class="w"> </span>-sS<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>localhost:9200/_plugins/_query/settings<span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;transient&quot; : {&quot;plugins.ppl.enabled&quot; : null}}&#39;</span>
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;acknowledged&quot;</span>:<span class="w"> </span>true,
<span class="w">  </span><span class="s2">&quot;persistent&quot;</span>:<span class="w"> </span><span class="o">{}</span>,
<span class="w">  </span><span class="s2">&quot;transient&quot;</span>:<span class="w"> </span><span class="o">{}</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
<section id="plugins-query-memory-limit">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">plugins.query.memory_limit</a><a class="headerlink" href="#plugins-query-memory-limit" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3>Description<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>You can set heap memory usage limit for the query engine. When query running, it will detected whether the heap memory usage under the limit, if not, it will terminated the current query. The default value is: 85%</p>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h3>
<p>PPL query:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sh$<span class="w"> </span>curl<span class="w"> </span>-sS<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>localhost:9200/_plugins/_query/settings<span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;persistent&quot; : {&quot;plugins.query.memory_limit&quot; : &quot;80%&quot;}}&#39;</span>
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;acknowledged&quot;</span>:<span class="w"> </span>true,
<span class="w">  </span><span class="s2">&quot;persistent&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;plugins&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">      </span><span class="s2">&quot;query&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="s2">&quot;memory_limit&quot;</span>:<span class="w"> </span><span class="s2">&quot;80%&quot;</span>
<span class="w">      </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">}</span>,
<span class="w">  </span><span class="s2">&quot;transient&quot;</span>:<span class="w"> </span><span class="o">{}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Note: the legacy settings of <code class="docutils literal notranslate"><span class="pre">opendistro.ppl.query.memory_limit</span></code> is deprecated, it will fallback to the new settings if you request an update with the legacy name.</p>
</section>
</section>
<section id="plugins-query-size-limit">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">plugins.query.size_limit</a><a class="headerlink" href="#plugins-query-size-limit" title="Link to this heading">¶</a></h2>
<section id="id2">
<h3>Description<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>The size configure the maximum amount of documents to be pull from OpenSearch. The default value is: 200</p>
<p>Notes: This setting will impact the correctness of the aggregation operation, for example, there are 1000 docs in the index, by default, only 200 docs will be extract from index and do aggregation.</p>
</section>
<section id="id3">
<h3>Example<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Change the size_limit to 1000:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sh$<span class="w"> </span>curl<span class="w"> </span>-sS<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>localhost:9200/_plugins/_query/settings<span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;persistent&quot; : {&quot;plugins.query.size_limit&quot; : &quot;1000&quot;}}&#39;</span>
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;acknowledged&quot;</span>:<span class="w"> </span>true,
<span class="w">  </span><span class="s2">&quot;persistent&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;plugins&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">      </span><span class="s2">&quot;query&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="s2">&quot;size_limit&quot;</span>:<span class="w"> </span><span class="s2">&quot;1000&quot;</span>
<span class="w">      </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">}</span>,
<span class="w">  </span><span class="s2">&quot;transient&quot;</span>:<span class="w"> </span><span class="o">{}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Rollback to default value:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sh$<span class="w"> </span>curl<span class="w"> </span>-sS<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>localhost:9200/_plugins/_query/settings<span class="w"> </span><span class="se">\</span>
...<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;persistent&quot; : {&quot;plugins.query.size_limit&quot; : null}}&#39;</span>
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;acknowledged&quot;</span>:<span class="w"> </span>true,
<span class="w">  </span><span class="s2">&quot;persistent&quot;</span>:<span class="w"> </span><span class="o">{}</span>,
<span class="w">  </span><span class="s2">&quot;transient&quot;</span>:<span class="w"> </span><span class="o">{}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Note: the legacy settings of <code class="docutils literal notranslate"><span class="pre">opendistro.query.size_limit</span></code> is deprecated, it will fallback to the new settings if you request an update with the legacy name.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">sql-docs</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, josh.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../../_sources/docs/user/ppl/admin/settings.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>