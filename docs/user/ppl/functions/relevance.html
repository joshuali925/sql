<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Relevance Functions &#8212; sql-docs  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="relevance-functions">
<h1>Relevance Functions<a class="headerlink" href="#relevance-functions" title="Link to this heading">¶</a></h1>
<p class="rubric">Table of contents</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#match" id="id7">MATCH</a></p></li>
<li><p><a class="reference internal" href="#match-phrase" id="id8">MATCH_PHRASE</a></p></li>
<li><p><a class="reference internal" href="#match-phrase-prefix" id="id9">MATCH_PHRASE_PREFIX</a></p></li>
<li><p><a class="reference internal" href="#multi-match" id="id10">MULTI_MATCH</a></p></li>
<li><p><a class="reference internal" href="#simple-query-string" id="id11">SIMPLE_QUERY_STRING</a></p></li>
<li><p><a class="reference internal" href="#match-bool-prefix" id="id12">MATCH_BOOL_PREFIX</a></p></li>
<li><p><a class="reference internal" href="#query-string" id="id13">QUERY_STRING</a></p></li>
</ul>
</nav>
<p>The relevance based functions enable users to search the index for documents by the relevance of the input query. The functions are built on the top of the search queries of the OpenSearch engine, but in memory execution within the plugin is not supported. These functions are able to perform the global filter of a query, for example the condition expression in a <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause or in a <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> clause. For more details of the relevance based search, check out the design here: <a class="reference external" href="https://github.com/opensearch-project/sql/issues/182">Relevance Based Search With SQL/PPL Query Engine</a></p>
<section id="match">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">MATCH</a><a class="headerlink" href="#match" title="Link to this heading">¶</a></h2>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">match(field_expression,</span> <span class="pre">query_expression[,</span> <span class="pre">option=&lt;option_value&gt;]*)</span></code></p>
<p>The match function maps to the match query used in search engine, to return the documents that match a provided text, number, date or boolean value with a given field. Available parameters include:</p>
<ul class="simple">
<li><p>analyzer</p></li>
<li><p>auto_generate_synonyms_phrase</p></li>
<li><p>fuzziness</p></li>
<li><p>max_expansions</p></li>
<li><p>prefix_length</p></li>
<li><p>fuzzy_transpositions</p></li>
<li><p>fuzzy_rewrite</p></li>
<li><p>lenient</p></li>
<li><p>operator</p></li>
<li><p>minimum_should_match</p></li>
<li><p>zero_terms_query</p></li>
<li><p>boost</p></li>
</ul>
<p>Example with only <code class="docutils literal notranslate"><span class="pre">field</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> expressions, and all other parameters are set default values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">accounts</span> <span class="o">|</span> <span class="n">where</span> <span class="n">match</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="s1">&#39;Street&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="n">lastname</span><span class="p">,</span> <span class="n">address</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+------------+--------------------+</span>
<span class="o">|</span> <span class="n">lastname</span>   <span class="o">|</span> <span class="n">address</span>            <span class="o">|</span>
<span class="o">|------------+--------------------|</span>
<span class="o">|</span> <span class="n">Bond</span>       <span class="o">|</span> <span class="mi">671</span> <span class="n">Bristol</span> <span class="n">Street</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Bates</span>      <span class="o">|</span> <span class="mi">789</span> <span class="n">Madison</span> <span class="n">Street</span> <span class="o">|</span>
<span class="o">+------------+--------------------+</span>
</pre></div>
</div>
<p>Another example to show how to set custom values for the optional parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">accounts</span> <span class="o">|</span> <span class="n">where</span> <span class="n">match</span><span class="p">(</span><span class="n">firstname</span><span class="p">,</span> <span class="s1">&#39;Hattie&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="s1">&#39;AND&#39;</span><span class="p">,</span> <span class="n">boost</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="n">lastname</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+------------+</span>
<span class="o">|</span> <span class="n">lastname</span>   <span class="o">|</span>
<span class="o">|------------|</span>
<span class="o">|</span> <span class="n">Bond</span>       <span class="o">|</span>
<span class="o">+------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="match-phrase">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">MATCH_PHRASE</a><a class="headerlink" href="#match-phrase" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3>Description<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">match_phrase(field_expression,</span> <span class="pre">query_expression[,</span> <span class="pre">option=&lt;option_value&gt;]*)</span></code></p>
<p>The match_phrase function maps to the match_phrase query used in search engine, to return the documents that match a provided text with a given field. Available parameters include:</p>
<ul class="simple">
<li><p>analyzer</p></li>
<li><p>slop</p></li>
<li><p>zero_terms_query</p></li>
</ul>
<p>For backward compatibility, matchphrase is also supported and mapped to match_phrase query as well.</p>
<p>Example with only <code class="docutils literal notranslate"><span class="pre">field</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> expressions, and all other parameters are set default values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">match_phrase</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="s1">&#39;Alexander Milne&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="n">author</span><span class="p">,</span> <span class="n">title</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------------------+--------------------------+</span>
<span class="o">|</span> <span class="n">author</span>               <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span>
<span class="o">|----------------------+--------------------------|</span>
<span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span> <span class="n">Winnie</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">Pooh</span>          <span class="o">|</span>
<span class="o">+----------------------+--------------------------+</span>
</pre></div>
</div>
<p>Another example to show how to set custom values for the optional parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">match_phrase</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="s1">&#39;Alan Milne&#39;</span><span class="p">,</span> <span class="n">slop</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="n">author</span><span class="p">,</span> <span class="n">title</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------------------+--------------------------+</span>
<span class="o">|</span> <span class="n">author</span>               <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span>
<span class="o">|----------------------+--------------------------|</span>
<span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span> <span class="n">Winnie</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">Pooh</span>          <span class="o">|</span>
<span class="o">+----------------------+--------------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="match-phrase-prefix">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">MATCH_PHRASE_PREFIX</a><a class="headerlink" href="#match-phrase-prefix" title="Link to this heading">¶</a></h2>
<section id="id2">
<h3>Description<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">match_phrase_prefix(field_expression,</span> <span class="pre">query_expression[,</span> <span class="pre">option=&lt;option_value&gt;]*)</span></code></p>
<p>The match_phrase_prefix function maps to the match_phrase_prefix query used in search engine, to return the documents that match a provided text with a given field. Available parameters include:</p>
<ul class="simple">
<li><p>analyzer</p></li>
<li><p>slop</p></li>
<li><p>max_expansions</p></li>
<li><p>boost</p></li>
<li><p>zero_terms_query</p></li>
</ul>
<p>Example with only <code class="docutils literal notranslate"><span class="pre">field</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> expressions, and all other parameters are set default values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">match_phrase_prefix</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="s1">&#39;Alexander Mil&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="n">author</span><span class="p">,</span> <span class="n">title</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------------------+--------------------------+</span>
<span class="o">|</span> <span class="n">author</span>               <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span>
<span class="o">|----------------------+--------------------------|</span>
<span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span> <span class="n">Winnie</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">Pooh</span>          <span class="o">|</span>
<span class="o">+----------------------+--------------------------+</span>
</pre></div>
</div>
<p>Another example to show how to set custom values for the optional parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">match_phrase_prefix</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="s1">&#39;Alan Mil&#39;</span><span class="p">,</span> <span class="n">slop</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="n">author</span><span class="p">,</span> <span class="n">title</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+----------------------+--------------------------+</span>
<span class="o">|</span> <span class="n">author</span>               <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span>
<span class="o">|----------------------+--------------------------|</span>
<span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span> <span class="n">Winnie</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">Pooh</span>          <span class="o">|</span>
<span class="o">+----------------------+--------------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="multi-match">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">MULTI_MATCH</a><a class="headerlink" href="#multi-match" title="Link to this heading">¶</a></h2>
<section id="id3">
<h3>Description<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">multi_match([field_expression+],</span> <span class="pre">query_expression[,</span> <span class="pre">option=&lt;option_value&gt;]*)</span></code></p>
<p>The multi_match function maps to the multi_match query used in search engine, to return the documents that match a provided text, number, date or boolean value with a given field or fields.
The <strong>^</strong> lets you <em>boost</em> certain fields. Boosts are multipliers that weigh matches in one field more heavily than matches in other fields. The syntax allows to specify the fields in double quotes, single quotes, in backtick or even without any wrap. All fields search using star <code class="docutils literal notranslate"><span class="pre">&quot;*&quot;</span></code> is also available (star symbol should be wrapped). The weight is optional and should be specified using after the field name, it could be delimeted by the <cite>caret</cite> character or by whitespace. Please, refer to examples below:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">multi_match([&quot;Tags&quot;</span> <span class="pre">^</span> <span class="pre">2,</span> <span class="pre">'Title'</span> <span class="pre">3.4,</span> <span class="pre">`Body`,</span> <span class="pre">Comments</span> <span class="pre">^</span> <span class="pre">0.3],</span> <span class="pre">...)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">multi_match([&quot;*&quot;],</span> <span class="pre">...)</span></code></div>
</div>
<p>Available parameters include:</p>
<ul class="simple">
<li><p>analyzer</p></li>
<li><p>auto_generate_synonyms_phrase</p></li>
<li><p>cutoff_frequency</p></li>
<li><p>fuzziness</p></li>
<li><p>fuzzy_transpositions</p></li>
<li><p>lenient</p></li>
<li><p>max_expansions</p></li>
<li><p>minimum_should_match</p></li>
<li><p>operator</p></li>
<li><p>prefix_length</p></li>
<li><p>tie_breaker</p></li>
<li><p>type</p></li>
<li><p>slop</p></li>
<li><p>boost</p></li>
</ul>
<p>Example with only <code class="docutils literal notranslate"><span class="pre">fields</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> expressions, and all other parameters are set default values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">multi_match</span><span class="p">([</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s1">&#39;Pooh House&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="nb">id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+------+--------------------------+----------------------+</span>
<span class="o">|</span> <span class="nb">id</span>   <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span> <span class="n">author</span>               <span class="o">|</span>
<span class="o">|------+--------------------------+----------------------|</span>
<span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span>    <span class="o">|</span> <span class="n">Winnie</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">Pooh</span>          <span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span>
<span class="o">+------+--------------------------+----------------------+</span>
</pre></div>
</div>
<p>Another example to show how to set custom values for the optional parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">multi_match</span><span class="p">([</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s1">&#39;Pooh House&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="s1">&#39;AND&#39;</span><span class="p">,</span> <span class="n">analyzer</span><span class="o">=</span><span class="n">default</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="nb">id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+------+--------------------------+----------------------+</span>
<span class="o">|</span> <span class="nb">id</span>   <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span> <span class="n">author</span>               <span class="o">|</span>
<span class="o">|------+--------------------------+----------------------|</span>
<span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span>
<span class="o">+------+--------------------------+----------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="simple-query-string">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">SIMPLE_QUERY_STRING</a><a class="headerlink" href="#simple-query-string" title="Link to this heading">¶</a></h2>
<section id="id4">
<h3>Description<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">simple_query_string([field_expression+],</span> <span class="pre">query_expression[,</span> <span class="pre">option=&lt;option_value&gt;]*)</span></code></p>
<p>The simple_query_string function maps to the simple_query_string query used in search engine, to return the documents that match a provided text, number, date or boolean value with a given field or fields.
The <strong>^</strong> lets you <em>boost</em> certain fields. Boosts are multipliers that weigh matches in one field more heavily than matches in other fields. The syntax allows to specify the fields in double quotes, single quotes, in backtick or even without any wrap. All fields search using star <code class="docutils literal notranslate"><span class="pre">&quot;*&quot;</span></code> is also available (star symbol should be wrapped). The weight is optional and should be specified using after the field name, it could be delimeted by the <cite>caret</cite> character or by whitespace. Please, refer to examples below:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">simple_query_string([&quot;Tags&quot;</span> <span class="pre">^</span> <span class="pre">2,</span> <span class="pre">'Title'</span> <span class="pre">3.4,</span> <span class="pre">`Body`,</span> <span class="pre">Comments</span> <span class="pre">^</span> <span class="pre">0.3],</span> <span class="pre">...)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">simple_query_string([&quot;*&quot;],</span> <span class="pre">...)</span></code></div>
</div>
<p>Available parameters include:</p>
<ul class="simple">
<li><p>analyze_wildcard</p></li>
<li><p>analyzer</p></li>
<li><p>auto_generate_synonyms_phrase</p></li>
<li><p>flags</p></li>
<li><p>fuzziness</p></li>
<li><p>fuzzy_max_expansions</p></li>
<li><p>fuzzy_prefix_length</p></li>
<li><p>fuzzy_transpositions</p></li>
<li><p>lenient</p></li>
<li><p>default_operator</p></li>
<li><p>minimum_should_match</p></li>
<li><p>quote_field_suffix</p></li>
<li><p>boost</p></li>
</ul>
<p>Example with only <code class="docutils literal notranslate"><span class="pre">fields</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> expressions, and all other parameters are set default values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">simple_query_string</span><span class="p">([</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s1">&#39;Pooh House&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="nb">id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+------+--------------------------+----------------------+</span>
<span class="o">|</span> <span class="nb">id</span>   <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span> <span class="n">author</span>               <span class="o">|</span>
<span class="o">|------+--------------------------+----------------------|</span>
<span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span>    <span class="o">|</span> <span class="n">Winnie</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">Pooh</span>          <span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span>
<span class="o">+------+--------------------------+----------------------+</span>
</pre></div>
</div>
<p>Another example to show how to set custom values for the optional parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">simple_query_string</span><span class="p">([</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s1">&#39;Pooh House&#39;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">,</span> <span class="n">default_operator</span><span class="o">=</span><span class="s1">&#39;AND&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="nb">id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+------+--------------------------+----------------------+</span>
<span class="o">|</span> <span class="nb">id</span>   <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span> <span class="n">author</span>               <span class="o">|</span>
<span class="o">|------+--------------------------+----------------------|</span>
<span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span>
<span class="o">+------+--------------------------+----------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="match-bool-prefix">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">MATCH_BOOL_PREFIX</a><a class="headerlink" href="#match-bool-prefix" title="Link to this heading">¶</a></h2>
<section id="id5">
<h3>Description<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">match_bool_prefix(field_expression,</span> <span class="pre">query_expression)</span></code></p>
<p>The match_bool_prefix function maps to the match_bool_prefix query in the search engine. match_bool_prefix creates a match query from all but the last term in the query string. The last term is used to create a prefix query.</p>
<ul class="simple">
<li><p>analyzer</p></li>
<li><p>fuzziness</p></li>
<li><p>max_expansions</p></li>
<li><p>prefix_length</p></li>
<li><p>fuzzy_transpositions</p></li>
<li><p>operator</p></li>
<li><p>fuzzy_rewrite</p></li>
<li><p>minimum_should_match</p></li>
<li><p>boost</p></li>
</ul>
<p>Example with only <code class="docutils literal notranslate"><span class="pre">field</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> expressions, and all other parameters are set default values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">accounts</span> <span class="o">|</span> <span class="n">where</span> <span class="n">match_bool_prefix</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="s1">&#39;Bristol Stre&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="n">firstname</span><span class="p">,</span> <span class="n">address</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+-------------+--------------------+</span>
<span class="o">|</span> <span class="n">firstname</span>   <span class="o">|</span> <span class="n">address</span>            <span class="o">|</span>
<span class="o">|-------------+--------------------|</span>
<span class="o">|</span> <span class="n">Hattie</span>      <span class="o">|</span> <span class="mi">671</span> <span class="n">Bristol</span> <span class="n">Street</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Nanette</span>     <span class="o">|</span> <span class="mi">789</span> <span class="n">Madison</span> <span class="n">Street</span> <span class="o">|</span>
<span class="o">+-------------+--------------------+</span>
</pre></div>
</div>
<p>Another example to show how to set custom values for the optional parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">accounts</span> <span class="o">|</span> <span class="n">where</span> <span class="n">match_bool_prefix</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="s1">&#39;Bristol Stre&#39;</span><span class="p">,</span> <span class="n">minimum_should_match</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="n">firstname</span><span class="p">,</span> <span class="n">address</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+-------------+--------------------+</span>
<span class="o">|</span> <span class="n">firstname</span>   <span class="o">|</span> <span class="n">address</span>            <span class="o">|</span>
<span class="o">|-------------+--------------------|</span>
<span class="o">|</span> <span class="n">Hattie</span>      <span class="o">|</span> <span class="mi">671</span> <span class="n">Bristol</span> <span class="n">Street</span> <span class="o">|</span>
<span class="o">+-------------+--------------------+</span>
</pre></div>
</div>
</section>
</section>
<section id="query-string">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">QUERY_STRING</a><a class="headerlink" href="#query-string" title="Link to this heading">¶</a></h2>
<section id="id6">
<h3>Description<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">query_string([field_expression+],</span> <span class="pre">query_expression[,</span> <span class="pre">option=&lt;option_value&gt;]*)</span></code></p>
<p>The query_string function maps to the query_string query used in search engine, to return the documents that match a provided text, number, date or boolean value with a given field or fields.
The <strong>^</strong> lets you <em>boost</em> certain fields. Boosts are multipliers that weigh matches in one field more heavily than matches in other fields. The syntax allows to specify the fields in double quotes,
single quotes, in backtick or even without any wrap. All fields search using star <code class="docutils literal notranslate"><span class="pre">&quot;*&quot;</span></code> is also available (star symbol should be wrapped). The weight is optional and should be specified using after the field name,
it could be delimeted by the <cite>caret</cite> character or by whitespace. Please, refer to examples below:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">query_string([&quot;Tags&quot;</span> <span class="pre">^</span> <span class="pre">2,</span> <span class="pre">'Title'</span> <span class="pre">3.4,</span> <span class="pre">`Body`,</span> <span class="pre">Comments</span> <span class="pre">^</span> <span class="pre">0.3],</span> <span class="pre">...)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">query_string([&quot;*&quot;],</span> <span class="pre">...)</span></code></div>
</div>
<p>Available parameters include:</p>
<ul class="simple">
<li><p>analyzer</p></li>
<li><p>escape</p></li>
<li><p>allow_leading_wildcard</p></li>
<li><p>analyze_wildcard</p></li>
<li><p>auto_generate_synonyms_phrase_query</p></li>
<li><p>boost</p></li>
<li><p>default_operator</p></li>
<li><p>enable_position_increments</p></li>
<li><p>fuzziness</p></li>
<li><p>fuzzy_max_expansions</p></li>
<li><p>fuzzy_prefix_length</p></li>
<li><p>fuzzy_transpositions</p></li>
<li><p>fuzzy_rewrite</p></li>
<li><p>tie_breaker</p></li>
<li><p>lenient</p></li>
<li><p>type</p></li>
<li><p>max_determinized_states</p></li>
<li><p>minimum_should_match</p></li>
<li><p>quote_analyzer</p></li>
<li><p>phrase_slop</p></li>
<li><p>quote_field_suffix</p></li>
<li><p>rewrite</p></li>
<li><p>time_zone</p></li>
</ul>
<p>Example with only <code class="docutils literal notranslate"><span class="pre">fields</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> expressions, and all other parameters are set default values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">query_string</span><span class="p">([</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s1">&#39;Pooh House&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="nb">id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="o">+------+--------------------------+----------------------+</span>
<span class="o">|</span> <span class="nb">id</span>   <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span> <span class="n">author</span>               <span class="o">|</span>
<span class="o">|------+--------------------------+----------------------|</span>
<span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span>    <span class="o">|</span> <span class="n">Winnie</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">Pooh</span>          <span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span>
<span class="o">+------+--------------------------+----------------------+</span>
</pre></div>
</div>
<p>Another example to show how to set custom values for the optional parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">&gt;</span> <span class="n">source</span><span class="o">=</span><span class="n">books</span> <span class="o">|</span> <span class="n">where</span> <span class="n">query_string</span><span class="p">([</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s1">&#39;Pooh House&#39;</span><span class="p">,</span> <span class="n">default_operator</span><span class="o">=</span><span class="s1">&#39;AND&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">fields</span> <span class="nb">id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">;</span>
<span class="n">fetched</span> <span class="n">rows</span> <span class="o">/</span> <span class="n">total</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="o">+------+--------------------------+----------------------+</span>
<span class="o">|</span> <span class="nb">id</span>   <span class="o">|</span> <span class="n">title</span>                    <span class="o">|</span> <span class="n">author</span>               <span class="o">|</span>
<span class="o">|------+--------------------------+----------------------|</span>
<span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="n">The</span> <span class="n">House</span> <span class="n">at</span> <span class="n">Pooh</span> <span class="n">Corner</span> <span class="o">|</span> <span class="n">Alan</span> <span class="n">Alexander</span> <span class="n">Milne</span> <span class="o">|</span>
<span class="o">+------+--------------------------+----------------------+</span>
</pre></div>
</div>
</section>
<section id="limitations">
<h3>Limitations<a class="headerlink" href="#limitations" title="Link to this heading">¶</a></h3>
<p>The relevance functions are available to execute only in OpenSearch DSL but not in memory as of now, so the relevance search might fail for queries that are too complex to translate into DSL if the relevance function is following after a complex PPL query. To make your queries always work-able, it is recommended to place the relevance commands as close to the search command as possible, to ensure the relevance functions are eligible to push down. For example, a complex query like <code class="docutils literal notranslate"><span class="pre">search</span> <span class="pre">source</span> <span class="pre">=</span> <span class="pre">people</span> <span class="pre">|</span> <span class="pre">rename</span> <span class="pre">firstname</span> <span class="pre">as</span> <span class="pre">name</span> <span class="pre">|</span> <span class="pre">dedup</span> <span class="pre">account_number</span> <span class="pre">|</span> <span class="pre">fields</span> <span class="pre">name,</span> <span class="pre">account_number,</span> <span class="pre">balance,</span> <span class="pre">employer</span> <span class="pre">|</span> <span class="pre">where</span> <span class="pre">match(employer,</span> <span class="pre">'Open</span> <span class="pre">Search')</span> <span class="pre">|</span> <span class="pre">stats</span> <span class="pre">count()</span> <span class="pre">by</span> <span class="pre">city</span></code> could fail because it is difficult to translate to DSL, but it would be better if we rewrite it to an equivalent query as <code class="docutils literal notranslate"><span class="pre">search</span> <span class="pre">source</span> <span class="pre">=</span> <span class="pre">people</span> <span class="pre">|</span> <span class="pre">where</span> <span class="pre">match(employer,</span> <span class="pre">'Open</span> <span class="pre">Search')</span> <span class="pre">|</span> <span class="pre">rename</span> <span class="pre">firstname</span> <span class="pre">as</span> <span class="pre">name</span> <span class="pre">|</span> <span class="pre">dedup</span> <span class="pre">account_number</span> <span class="pre">|</span> <span class="pre">fields</span> <span class="pre">name,</span> <span class="pre">account_number,</span> <span class="pre">balance,</span> <span class="pre">employer</span> <span class="pre">|</span> <span class="pre">stats</span> <span class="pre">count()</span> <span class="pre">by</span> <span class="pre">city</span></code> by moving the where command with relevance function to the second command right after the search command, and the relevance would be optimized and executed smoothly in OpenSearch DSL. See <a class="reference external" href="../../optimization/optimization.rst">Optimization</a> to get more details about the query engine optimization.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">sql-docs</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, josh.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../../_sources/docs/user/ppl/functions/relevance.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>