<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Full-text Search &#8212; sql-docs  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="full-text-search">
<h1>Full-text Search<a class="headerlink" href="#full-text-search" title="Link to this heading">¶</a></h1>
<p class="rubric">Table of contents</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id8">Introduction</a></p></li>
<li><p><a class="reference internal" href="#match-query" id="id9">Match Query</a></p>
<ul>
<li><p><a class="reference internal" href="#description" id="id10">Description</a></p></li>
<li><p><a class="reference internal" href="#example-1" id="id11">Example 1</a></p></li>
<li><p><a class="reference internal" href="#example-2" id="id12">Example 2</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#multi-match-query" id="id13">Multi-match Query</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id14">Description</a></p></li>
<li><p><a class="reference internal" href="#example" id="id15">Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#query-string-query" id="id16">Query String Query</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id17">Description</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id18">Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#match-phrase-query" id="id19">Match Phrase Query</a></p>
<ul>
<li><p><a class="reference internal" href="#id4" id="id20">Description</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id21">Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#score-query" id="id22">Score Query</a></p>
<ul>
<li><p><a class="reference internal" href="#id6" id="id23">Description</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id24">Example</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>Full-text search is for searching a single stored document which is distinguished from regular search based on original texts in database. It tries to match search criteria by examining all of the words in each document. In OpenSearch, full-text queries provided enables you to search text fields analyzed during indexing.</p>
<p>This document describes the original SQL engine. It only applies to queries that cannot be handled by <cite>SQL engine V2 &lt;../../dev/NewSQLEngine.md&gt;</cite>. Documentation for full-text search using SQL Engine V2 can be found  <a class="reference external" href="../dql/functions.rst#relevance">here</a>.</p>
</section>
<section id="match-query">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Match Query</a><a class="headerlink" href="#match-query" title="Link to this heading">¶</a></h2>
<section id="description">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h3>
<p>Match query is the standard query for full-text search in OpenSearch. Both <code class="docutils literal notranslate"><span class="pre">MATCHQUERY</span></code> and <code class="docutils literal notranslate"><span class="pre">MATCH_QUERY</span></code> are functions for performing match query.</p>
</section>
<section id="example-1">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Example 1</a><a class="headerlink" href="#example-1" title="Link to this heading">¶</a></h3>
<p>Both functions can accept field name as first argument and a text as second argument.</p>
<p>SQL query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">_plugins</span><span class="o">/</span><span class="n">_sql</span>
<span class="p">{</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT account_number, address</span>
<span class="s2">        FROM accounts</span>
<span class="s2">        WHERE MATCH_QUERY(address, &#39;Holmes&#39;)</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;from&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;filter&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;must&quot;</span> <span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;match&quot;</span> <span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;address&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;Holmes&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;operator&quot;</span> <span class="p">:</span> <span class="s2">&quot;OR&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;prefix_length&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;max_expansions&quot;</span> <span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                    <span class="s2">&quot;fuzzy_transpositions&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;lenient&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                    <span class="s2">&quot;zero_terms_query&quot;</span> <span class="p">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;auto_generate_synonyms_phrase_query&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;account_number&quot;</span><span class="p">,</span>
      <span class="s2">&quot;address&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;excludes&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Result set:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>account_number</p></th>
<th class="head"><p>address</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>880 Holmes Lane</p></td>
</tr>
</tbody>
</table>
</section>
<section id="example-2">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Example 2</a><a class="headerlink" href="#example-2" title="Link to this heading">¶</a></h3>
<p>Both functions can also accept single argument and be used in the following manner.</p>
<p>SQL query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">_plugins</span><span class="o">/</span><span class="n">_sql</span>
<span class="p">{</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT account_number, address</span>
<span class="s2">        FROM accounts</span>
<span class="s2">        WHERE address = MATCH_QUERY(&#39;Holmes&#39;)</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;from&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;filter&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;must&quot;</span> <span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;match&quot;</span> <span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;address&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;Holmes&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;operator&quot;</span> <span class="p">:</span> <span class="s2">&quot;OR&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;prefix_length&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;max_expansions&quot;</span> <span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                    <span class="s2">&quot;fuzzy_transpositions&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;lenient&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                    <span class="s2">&quot;zero_terms_query&quot;</span> <span class="p">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;auto_generate_synonyms_phrase_query&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;account_number&quot;</span><span class="p">,</span>
      <span class="s2">&quot;address&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;excludes&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Result set:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>account_number</p></th>
<th class="head"><p>address</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>880 Holmes Lane</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="multi-match-query">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Multi-match Query</a><a class="headerlink" href="#multi-match-query" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Description</a><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>Besides match query against a single field, you can search for a text with multiple fields. Function <code class="docutils literal notranslate"><span class="pre">MULTI_MATCH</span></code>, <code class="docutils literal notranslate"><span class="pre">MULTIMATCH</span></code> and <code class="docutils literal notranslate"><span class="pre">MULTIMATCHQUERY</span></code> are provided for this.</p>
</section>
<section id="example">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Example</a><a class="headerlink" href="#example" title="Link to this heading">¶</a></h3>
<p>Each preceding function accepts <code class="docutils literal notranslate"><span class="pre">query</span></code> for a text and <code class="docutils literal notranslate"><span class="pre">fields</span></code> for field names or pattern that the text given is searched against. For example, the following query is searching for documents in index accounts with ‘Dale’ as either firstname or lastname.</p>
<p>SQL query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">_plugins</span><span class="o">/</span><span class="n">_sql</span>
<span class="p">{</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT firstname, lastname</span>
<span class="s2">        FROM accounts</span>
<span class="s2">        WHERE MULTI_MATCH(&#39;query&#39;=&#39;Dale&#39;, &#39;fields&#39;=&#39;*name&#39;)</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;from&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;filter&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;must&quot;</span> <span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;multi_match&quot;</span> <span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;Dale&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;fields&quot;</span> <span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;*name^1.0&quot;</span>
                  <span class="p">],</span>
                  <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;best_fields&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;operator&quot;</span> <span class="p">:</span> <span class="s2">&quot;OR&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;slop&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;prefix_length&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;max_expansions&quot;</span> <span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                  <span class="s2">&quot;zero_terms_query&quot;</span> <span class="p">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;auto_generate_synonyms_phrase_query&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                  <span class="s2">&quot;fuzzy_transpositions&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                  <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;firstname&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastname&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;excludes&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Result set:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>firstname</p></th>
<th class="head"><p>lastname</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Dale</p></td>
<td><p>Adams</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="query-string-query">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">Query String Query</a><a class="headerlink" href="#query-string-query" title="Link to this heading">¶</a></h2>
<section id="id2">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Description</a><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>Query string query parses and splits a query string provided based on Lucene query string syntax. The mini language supports logical connectives, wildcard, regex and proximity search. Please refer to official documentation for more details. Note that an error is thrown in the case of any invalid syntax in query string.</p>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Example</a><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">QUERY</span></code> function accepts query string and returns true or false respectively for document that matches the query string or not.</p>
<p>SQL query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">_plugins</span><span class="o">/</span><span class="n">_sql</span>
<span class="p">{</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT account_number, address</span>
<span class="s2">        FROM accounts</span>
<span class="s2">        WHERE QUERY(&#39;address:Lane OR address:Street&#39;)</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;from&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;filter&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;must&quot;</span> <span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;query_string&quot;</span> <span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;address:Lane OR address:Street&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;fields&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">],</span>
                  <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;best_fields&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;default_operator&quot;</span> <span class="p">:</span> <span class="s2">&quot;or&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;max_determinized_states&quot;</span> <span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
                  <span class="s2">&quot;enable_position_increments&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                  <span class="s2">&quot;fuzziness&quot;</span> <span class="p">:</span> <span class="s2">&quot;AUTO&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;fuzzy_prefix_length&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;fuzzy_max_expansions&quot;</span> <span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                  <span class="s2">&quot;phrase_slop&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;escape&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                  <span class="s2">&quot;auto_generate_synonyms_phrase_query&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                  <span class="s2">&quot;fuzzy_transpositions&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                  <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;account_number&quot;</span><span class="p">,</span>
      <span class="s2">&quot;address&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;excludes&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Result set:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>account_number</p></th>
<th class="head"><p>address</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>880 Holmes Lane</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>671 Bristol Street</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>789 Madison Street</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="match-phrase-query">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Match Phrase Query</a><a class="headerlink" href="#match-phrase-query" title="Link to this heading">¶</a></h2>
<section id="id4">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Description</a><a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>Match phrase query is similar to match query but it is used for matching exact phrases. <code class="docutils literal notranslate"><span class="pre">MATCHPHRASE</span></code>, <code class="docutils literal notranslate"><span class="pre">MATCH_PHRASE</span></code> and <code class="docutils literal notranslate"><span class="pre">MATCHPHRASEQUERY</span></code> are provided for this purpose.</p>
</section>
<section id="id5">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Example</a><a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>SQL query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">_plugins</span><span class="o">/</span><span class="n">_sql</span>
<span class="p">{</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT account_number, address</span>
<span class="s2">        FROM accounts</span>
<span class="s2">        WHERE MATCH_PHRASE(address, &#39;880 Holmes Lane&#39;)</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;from&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;filter&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;must&quot;</span> <span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;match_phrase&quot;</span> <span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;address&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;880 Holmes Lane&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;slop&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;zero_terms_query&quot;</span> <span class="p">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;account_number&quot;</span><span class="p">,</span>
      <span class="s2">&quot;address&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;excludes&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Result set:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>account_number</p></th>
<th class="head"><p>address</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>880 Holmes Lane</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="score-query">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">Score Query</a><a class="headerlink" href="#score-query" title="Link to this heading">¶</a></h2>
<section id="id6">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Description</a><a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>OpenSearch supports to wrap a filter query so as to return a relevance score along with every matching document. <code class="docutils literal notranslate"><span class="pre">SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">SCOREQUERY</span></code> and <code class="docutils literal notranslate"><span class="pre">SCORE_QUERY</span></code> can be used for this.</p>
</section>
<section id="id7">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Example</a><a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>The first argument is a match query expression and the second argument is for an optional floating point number to boost the score. The default value is 1.0. Apart from this, an implicit variable <code class="docutils literal notranslate"><span class="pre">_score</span></code> is available so you can return score for each document or use it for sorting.</p>
<p>SQL query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">_plugins</span><span class="o">/</span><span class="n">_sql</span>
<span class="p">{</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT account_number, address, _score</span>
<span class="s2">        FROM accounts</span>
<span class="s2">        WHERE SCORE(MATCH_QUERY(address, &#39;Lane&#39;), 0.5) OR</span>
<span class="s2">          SCORE(MATCH_QUERY(address, &#39;Street&#39;), 100)</span>
<span class="s2">        ORDER BY _score</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;from&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;must&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;should&quot;</span> <span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;constant_score&quot;</span> <span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;filter&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;match&quot;</span> <span class="p">:</span> <span class="p">{</span>
                      <span class="s2">&quot;address&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;Lane&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;operator&quot;</span> <span class="p">:</span> <span class="s2">&quot;OR&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;prefix_length&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;max_expansions&quot;</span> <span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                        <span class="s2">&quot;fuzzy_transpositions&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                        <span class="s2">&quot;lenient&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                        <span class="s2">&quot;zero_terms_query&quot;</span> <span class="p">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;auto_generate_synonyms_phrase_query&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                        <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
                      <span class="p">}</span>
                    <span class="p">}</span>
                  <span class="p">},</span>
                  <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">0.5</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="p">{</span>
                <span class="s2">&quot;constant_score&quot;</span> <span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;filter&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;match&quot;</span> <span class="p">:</span> <span class="p">{</span>
                      <span class="s2">&quot;address&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;Street&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;operator&quot;</span> <span class="p">:</span> <span class="s2">&quot;OR&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;prefix_length&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;max_expansions&quot;</span> <span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                        <span class="s2">&quot;fuzzy_transpositions&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                        <span class="s2">&quot;lenient&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                        <span class="s2">&quot;zero_terms_query&quot;</span> <span class="p">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;auto_generate_synonyms_phrase_query&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                        <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
                      <span class="p">}</span>
                    <span class="p">}</span>
                  <span class="p">},</span>
                  <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">100.0</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;adjust_pure_negative&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;boost&quot;</span> <span class="p">:</span> <span class="mf">1.0</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;account_number&quot;</span><span class="p">,</span>
      <span class="s2">&quot;address&quot;</span><span class="p">,</span>
      <span class="s2">&quot;_score&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;excludes&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;sort&quot;</span> <span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_score&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;order&quot;</span> <span class="p">:</span> <span class="s2">&quot;asc&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Result set:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>account_number</p></th>
<th class="head"><p>address</p></th>
<th class="head"><p>_score</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>880 Holmes Lane</p></td>
<td><p>0.5</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>671 Bristol Street</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>789 Madison Street</p></td>
<td><p>100</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">sql-docs</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, josh.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../_sources/docs/user/beyond/fulltext.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>