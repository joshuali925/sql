<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Limitations &#8212; sql-docs  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="limitations">
<h1>Limitations<a class="headerlink" href="#limitations" title="Link to this heading">¶</a></h1>
<p class="rubric">Table of contents</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#limitations-on-identifiers" id="id2">Limitations on Identifiers</a></p></li>
<li><p><a class="reference internal" href="#limitations-on-fields" id="id3">Limitations on Fields</a></p></li>
<li><p><a class="reference internal" href="#limitations-on-aggregations" id="id4">Limitations on Aggregations</a></p></li>
<li><p><a class="reference internal" href="#limitations-on-joins" id="id5">Limitations on JOINs</a></p></li>
<li><p><a class="reference internal" href="#limitations-on-window-functions" id="id6">Limitations on Window Functions</a></p></li>
<li><p><a class="reference internal" href="#limitations-on-pagination" id="id7">Limitations on Pagination</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>In this doc, the restrictions and limitations of SQL plugin is covered as follows.</p>
</section>
<section id="limitations-on-identifiers">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Limitations on Identifiers</a><a class="headerlink" href="#limitations-on-identifiers" title="Link to this heading">¶</a></h2>
<p>Using OpenSearch cluster name as dataSource name to qualify an index name, such as <code class="docutils literal notranslate"><span class="pre">my_cluster.my_index</span></code>, is not supported for now.</p>
</section>
<section id="limitations-on-fields">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Limitations on Fields</a><a class="headerlink" href="#limitations-on-fields" title="Link to this heading">¶</a></h2>
<p>We are not supporting use <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/alias.html">alias field type</a> as identifier. It will throw exception <code class="docutils literal notranslate"><span class="pre">can't</span> <span class="pre">resolve</span> <span class="pre">Symbol</span></code>.</p>
</section>
<section id="limitations-on-aggregations">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Limitations on Aggregations</a><a class="headerlink" href="#limitations-on-aggregations" title="Link to this heading">¶</a></h2>
<p>Aggregation over expression is not supported for now. You can only apply aggregation on fields, aggregations can’t accept an expression as a parameter. For example, <cite>avg(log(age))</cite> is not supported.</p>
<p>Here’s a link to the Github issue - [Issue #288](<a class="reference external" href="https://github.com/opendistro-for-elasticsearch/sql/issues/288">https://github.com/opendistro-for-elasticsearch/sql/issues/288</a>).</p>
</section>
<section id="limitations-on-joins">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Limitations on JOINs</a><a class="headerlink" href="#limitations-on-joins" title="Link to this heading">¶</a></h2>
<p>JOIN does not support aggregations on the joined result. The <cite>join</cite> query does not support aggregations on the joined result.
For example, e.g. <cite>SELECT depo.name, avg(empo.age) FROM empo JOIN depo WHERE empo.id == depo.id GROUP BY depo.name</cite> is not supported.</p>
<p>Here’s a link to the Github issue - <a class="reference external" href="https://github.com/opendistro-for-elasticsearch/sql/issues/110">Issue 110</a>.</p>
</section>
<section id="limitations-on-window-functions">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Limitations on Window Functions</a><a class="headerlink" href="#limitations-on-window-functions" title="Link to this heading">¶</a></h2>
<p>For now, only the field defined in index is allowed, all the other calculated fields (calculated by scalar or aggregated functions) is not allowed. For example, either <code class="docutils literal notranslate"><span class="pre">avg_flight_time</span></code> or <code class="docutils literal notranslate"><span class="pre">AVG(FlightTimeMin)</span></code> is not accessible to the rank window definition as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">OriginCountry</span><span class="p">,</span> <span class="n">AVG</span><span class="p">(</span><span class="n">FlightTimeMin</span><span class="p">)</span> <span class="n">AS</span> <span class="n">avg_flight_time</span><span class="p">,</span>
       <span class="n">RANK</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">ORDER</span> <span class="n">BY</span> <span class="n">avg_flight_time</span><span class="p">)</span> <span class="n">AS</span> <span class="n">rnk</span>
<span class="n">FROM</span> <span class="n">opensearch_dashboards_sample_data_flights</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">OriginCountry</span>
</pre></div>
</div>
<p>Another limitation is that currently window function cannot be nested in another expression, for example, <code class="docutils literal notranslate"><span class="pre">CASE</span> <span class="pre">WHEN</span> <span class="pre">RANK()</span> <span class="pre">OVER(...)</span> <span class="pre">THEN</span> <span class="pre">...</span></code>.</p>
<p>Workaround for both limitations mentioned above is using a sub-query in FROM clause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span>
  <span class="n">SUM</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">avg_flight_time</span><span class="p">)</span> <span class="n">OVER</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">FROM</span> <span class="p">(</span>
    <span class="n">SELECT</span> <span class="n">OriginCountry</span><span class="p">,</span> <span class="n">AVG</span><span class="p">(</span><span class="n">FlightTimeMin</span><span class="p">)</span> <span class="n">AS</span> <span class="n">avg_flight_time</span><span class="p">,</span>
    <span class="n">FROM</span> <span class="n">opensearch_dashboards_sample_data_flights</span>
    <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">OriginCountry</span>
<span class="p">)</span> <span class="n">AS</span> <span class="n">t</span>
</pre></div>
</div>
</section>
<section id="limitations-on-pagination">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Limitations on Pagination</a><a class="headerlink" href="#limitations-on-pagination" title="Link to this heading">¶</a></h2>
<p>Pagination only supports basic queries for now. The pagination query enables you to get back paginated responses.
Currently, the pagination only supports basic queries. For example, the following query returns the data with cursor id:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="n">_plugins</span><span class="o">/</span><span class="n">_sql</span><span class="o">/</span>
<span class="p">{</span>
  <span class="s2">&quot;fetch_size&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;SELECT OriginCountry, DestCountry FROM opensearch_dashboards_sample_data_flights ORDER BY OriginCountry ASC&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The response in JDBC format with cursor id:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;OriginCountry&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;keyword&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DestCountry&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;keyword&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;d:eyJhIjp7fSwicyI6IkRYRjFaWEo1UVc1a1JtVjBZMmdCQUFBQUFBQUFCSllXVTJKVU4yeExiWEJSUkhsNFVrdDVXVEZSYkVKSmR3PT0iLCJjIjpbeyJuYW1lIjoiT3JpZ2luQ291bnRyeSIsInR5cGUiOiJrZXl3b3JkIn0seyJuYW1lIjoiRGVzdENvdW50cnkiLCJ0eXBlIjoia2V5d29yZCJ9XSwiZiI6MSwiaSI6ImtpYmFuYV9zYW1wbGVfZGF0YV9mbGlnaHRzIiwibCI6MTMwNTh9&quot;</span><span class="p">,</span>
  <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="mi">13059</span><span class="p">,</span>
  <span class="s2">&quot;datarows&quot;</span><span class="p">:</span> <span class="p">[[</span>
    <span class="s2">&quot;AE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CN&quot;</span>
  <span class="p">]],</span>
  <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The query with <cite>aggregation</cite> and <cite>join</cite> does not support pagination for now.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">sql-docs</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, josh.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../_sources/docs/user/limitations/limitations.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>